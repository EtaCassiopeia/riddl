![Code Build Status](https://github.com/reactific/riddl/actions/workflows/scala.yml/badge.svg)
![Documentation Build Status](https://github.com/reactific/riddl/actions/workflows/gh-pages.yml/badge.svg)
[![CLA assistant](https://cla-assistant.io/readme/badge/reactific/riddl)](https://cla-assistant.io/reactific/riddl)

# RIDDL

## Full Documentation
Is here: https://riddl.tech


## Introduction
RIDDL, the Reactive Interface to Domain Definition Language, is a specification
lanugage and tooling to help capture requirements and specify designs for the
class of systems that can be designed with DDD and utilize a distributed, reactive
cloud native architecture.  


RIDDL allows subject matter experts, business analysts, and system architects to
work at a higher level of abstraction than they would if they were coding directly
in a programming language. RIDDL aims to relieve developers of the burden of 
maintaining infrastructural code through evolution of the system abstractions.

## Important Documentation Sections

* [Introduction](https://riddl.tech/introduction/) - answer the important initial questions
* [Concepts](https://riddl.tech/concepts/) - provides a conceptual understanding of RIDDL before diving into the details
* [Guides](https://riddl.tech/guides/) - four guides for different kinds of RIDDL audiences.
* [riddlc](https://riddl.tech/tooling/riddlc/) - various ways to obtain the RIDDL compiler

## Install With `brew`
TBD

## Quickly Use On Your Computer
To use `riddlc` locally and be able to update it with new changes, use this approach:
* `git clone` the latest content and change directory to that cloned repository
* Put the `.../riddl/riddlc/target/universal/stage/bin` directory in your PATH 
  variable
* Run `sbt stage` to build the program
* To update, run `git pull` from the `riddl` cloned repository directory and
  rerun the sbt command above to rebuild. 

This allows you to both make local changes and pull in changes from others to
keep your local copy of `riddlc` up to date. 

## Using A Release
Starting with the 0.6.0 a "universal" release bundle is made avalable for 
Linux and MacOS Systems directly from GitHub. You can find them in the 
[GitHub Releases](https://github.com/reactific/riddl/releases) section 
under "Assets"

After downloading the `.zip` asset, you should:

* Move that `.zip` file to somewhere in your home directory
* Unpack that `.zip` file with  `unzip <path-to-tgz>` 
* That will give you a directory like `riddl-0.6.0/bin` (the version # might
  be different)
* Put that `bin` directory in your path
* Now you can just run “riddlc” from anywhere
* Some day we will have a packaged installer.

## Adding `riddlc` to your project workflow
* See the reactific/riddl-actions project for actions that make riddlc invokable 
  in your own GitHub workflows

## Using RIDDL From Code
In your `project/plugins.sbt` file, use:
```shell
addSbtPlugin("com.reactific" % "sbt-riddl" % "<version>")
```

## Usage
To get the most recent options, run `riddlc help`. That command will give you
the syntax for doing various things with the riddl compiler (`riddlc`)

## Version / Info
The `riddlc` compiler has two command, `info` and `version` that just print
out information and the version number, respectively, and then exit. 

## Dependencies

This codebase targets Java 17 and Scala 2.13.7 with -XSource:3 in preparation for 
Scala 3.0 code conversion. Moving to Scala 3 requires all dependencies to make 
the same transition:
* fastparse uses macros and is waiting for bugs in scala 3 to be fixed
* pureconfig is nearly ready for scala 3

## Generating Documentation
Documentation is now generated by sbt-site and its HugoPlugin for sbt.  However,
to read and write documentation it is generally better to work directly with hugo.
You need to make sure Hugo is installed:
```shell
brew install hugo  
```
Then run the hugo server:
```shell
cd doc/src/hugo
hugo server --disableFastRender -D
```
The hugo server command will ensure that writes to the source files will cause
the server to eject built pages from memory cache and rebuild them from the
source the next time they are requested. To view the site in your browser:
```shell
open http://localhost:1313/
```

## Ways To Test RIDDL
### ScalaTest
There are many test points already defined in language/src/tests/scala using
ScalaTest. In general, any change in language should be done in TDD style with
tests cases written before code to make that test case pass.  This is how the
parser and validator were created. That tradition needs to continue. 

### "Check" Tests
In `language/src/test/input` there are a variety of tests with `.check` files
that have the same basename as the `.riddl` file. The `.check` files have 
the error output that is expected from validating the correctly parsing `.
riddl` file. This way we can identify changes in error and messages. These 
tests are performed by the `CheckMessagesTest.scala` test suite which will
read all the riddl files in test/input/check and check them for validity and
compare the output messages to what's in the `.check` file. If there is no
corresponding `.check` file then the `.riddl` file is expected to validate 
cleanly with no errors and no warnings.

This is where most regression tests should be added. The input should be 
whittled down to the smallest set of definitions that cause a problem to 
occur, and then it should succeed after the regression is fixed.  

### "Examples" Tests
In `examples/src/test/scala` there is a `CheckExamplesSpec.scala` which runs 
the parser and validator on the examples in `examples/src/riddl`. Each 
sub-directory there is a separate example. They are expected to parse and 
validate cleanly without issue 

### Contributing
_Contributions are very welcome!_

If you see an issue that you'd like to see fixed, or want us to consider a
change, the best way to make it happen is to help out by submitting a 
pull request implementing it. We welcome contributions from all, even if
you are not yet familiar RIDDL. We will endeavour to guide you through the 
process once you've submitted your PR. 

Please refer to the CONTRIBUTING.md file for more details about the workflow, 
and general hints on how to prepare your pull request. You can also ask for
clarifications or guidance in GitHub issues directly

